# tic documentation: https://docs.ropensci.org/tic/dev/

# Download script file from GitHub
init:
  ps: |
    $ErrorActionPreference = "Stop"
    Invoke-WebRequest http://raw.github.com/krlmlr/r-appveyor/master/scripts/appveyor-tool.ps1 -OutFile "..\appveyor-tool.ps1"
    Import-Module '..\appveyor-tool.ps1'

install:
  - ps: Bootstrap
  - cmd: Rscript -e "writeLines('options(repos = \'https://cloud.r-project.org\')', '~/.Rprofile')"
  - cmd: Rscript -e "getOption('repos')"
  - cmd: Rscript -e "if (!requireNamespace('remotes')) install.packages('remotes', type = 'binary')"
  - cmd: Rscript -e "if (getRversion() < '3.2' && !requireNamespace('curl')) install.packages('curl', type = 'binary')"
  - cmd: Rscript -e "options(pkgType = 'binary'); remotes::install_github('ropensci/tic@do-drat', upgrade = 'always'); print(tic::dsl_load()); tic::prepare_all_stages()"

before_build: Rscript -e "tic::before_install()"
build_script: Rscript -e "tic::install()"
after_build: Rscript -e "tic::after_install()"
before_test: Rscript -e "tic::before_script()"
test_script: Rscript -e "tic::script()"
on_success: Rscript -e "try(tic::after_success(), silent = TRUE)"
on_failure: Rscript -e "tic::after_failure()"
before_deploy: Rscript -e "tic::before_deploy()"
deploy_script: Rscript -e "tic::deploy()"
after_deploy: Rscript -e "tic::after_deploy()"
on_finish: Rscript -e "tic::after_script()"

# no testing on R-devel because no package binaries are available
environment:
  matrix:
    - R_VERSION: release
    - R_VERSION: oldrel
  GITHUB_PAT:
    secure: VXO22OHLkl4YhVIomSMwCZyOTx03Xf2WICaVng9xH7gISlAg8a+qrt1DtFtk8sK5
  id_rsa:
    secure: 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
  USE_RTOOLS: true

matrix:
  fast_finish: true
# Custom user code -------------------------------------------------------------
