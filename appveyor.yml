# tic documentation: https://docs.ropensci.org/tic/dev/

# Download script file from GitHub
init:
  ps: |
    $ErrorActionPreference = "Stop"
    Invoke-WebRequest http://raw.github.com/krlmlr/r-appveyor/master/scripts/appveyor-tool.ps1 -OutFile "..\appveyor-tool.ps1"
    Import-Module '..\appveyor-tool.ps1'

install:
  - ps: Bootstrap
  - cmd: Rscript -e "writeLines('options(repos = \'https://cloud.r-project.org\')', '~/.Rprofile')"
  - cmd: Rscript -e "getOption('repos')"
  - cmd: Rscript -e "if (!requireNamespace('remotes')) install.packages('remotes', type = 'binary')"
  - cmd: Rscript -e "if (getRversion() < '3.2' && !requireNamespace('curl')) install.packages('curl', type = 'binary')"
  - cmd: Rscript -e "options(pkgType = 'binary'); remotes::install_github('ropenscilabs/tic'); print(tic::dsl_load()); tic::prepare_all_stages()"

before_build: Rscript -e "tic::before_install()"
build_script: Rscript -e "tic::install()"
after_build: Rscript -e "tic::after_install()"
before_test: Rscript -e "tic::before_script()"
test_script: Rscript -e "tic::script()"
on_success: Rscript -e "try(tic::after_success(), silent = TRUE)"
on_failure: Rscript -e "tic::after_failure()"
before_deploy: R -q -e "tic::before_deploy()"
deploy_script: R -q -e "tic::deploy()"
after_deploy: R -q -e "tic::after_deploy()"
on_finish: Rscript -e "tic::after_script()"

# no testing on R-devel because no package binaries are available
environment:
  matrix:
    - R_VERSION: release
    - R_VERSION: oldrel
  GITHUB_PAT:
    secure: VXO22OHLkl4YhVIomSMwCZyOTx03Xf2WICaVng9xH7gISlAg8a+qrt1DtFtk8sK5
  id_rsa:
    secure: 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

matrix:
  fast_finish: true
# Custom user code -------------------------------------------------------------
